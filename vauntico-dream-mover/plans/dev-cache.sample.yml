version: 1
targetDrive: "D:"
modes:
  safety: "advanced"
  linking: "preferred"

rules:
  # Link the global npm prefix (Roaming npm) via junction to D:\Dev\Node
  - name: Link global npm (Roaming)
    match:
      paths:
        - "C:\\Users\\%USER%\\AppData\\Roaming\\npm"   # Windows
        # - "$HOME/.npm"                                      # Linux/macOS (uncomment to use)
        # - "$HOME/.npm-global"                               # Alternative npm prefix
      sizeMinMB: 10
    action:
      type: link
      destination: "D:\\Dev\\Node"
      linkType: junction
      verify: sample   # sample hashing keeps verification fast for many small files
      rollback: auto

  # Link pnpm store to D:\Dev\pnpm
  - name: Link pnpm store
    match:
      paths:
        - "C:\\Users\\%USER%\\AppData\\Local\\pnpm\\store"  # Windows
        # - "$HOME/.pnpm-store"                                    # Linux/macOS (uncomment to use)
      sizeMinMB: 50
    action:
      type: link
      destination: "D:\\Dev\\pnpm"
      linkType: junction
      verify: sample
      rollback: auto

  # Link project node_modules (any path containing \node_modules\) to D:\Dev\Node
  - name: Link project node_modules
    match:
      patterns:
        - "\\node_modules\\"    # Windows
        # - "/node_modules/"     # Linux/macOS (uncomment to use)
      sizeMinMB: 50
    action:
      type: link
      destination: "D:\\Dev\\Node"
      linkType: junction          # On Linux/macOS, change to: symlink
      verify: sample
      rollback: auto
